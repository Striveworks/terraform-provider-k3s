package k3s

import (
	"strings"
	"testing"
)

const raw = `apiVersion: v1
clusters:
- cluster:
    certificate-authority-data: LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSUJkekNDQVIyZ0F3SUJBZ0lCQURBS0JnZ3Foa2pPUFFRREFqQWpNU0V3SHdZRFZRUUREQmhyTTNNdGMyVnkKZG1WeUxXTmhRREUzTkRneE9EVTFORFF3SGhjTk1qVXdOVEkxTVRVd05UUTBXaGNOTXpVd05USXpNVFV3TlRRMApXakFqTVNFd0h3WURWUVFEREJock0zTXRjMlZ5ZG1WeUxXTmhRREUzTkRneE9EVTFORFF3V1RBVEJnY3Foa2pPClBRSUJCZ2dxaGtqT1BRTUJCd05DQUFUa0w1dHF1czdESXRpVklCN1FFcG1nQ1Q1Z3R2NUJVRjV5SHJQYWZMaGsKdG1ZWWpkTXE0eldlSmJPLzI1QWZIU1QyT09EazV1bzNWb3dRbk83eEdzRkZvMEl3UURBT0JnTlZIUThCQWY4RQpCQU1DQXFRd0R3WURWUjBUQVFIL0JBVXdBd0VCL3pBZEJnTlZIUTRFRmdRVVVTNlVycmhWWDh5b0FuQ0dMOEJLCmYyZ0VNZDB3Q2dZSUtvWkl6ajBFQXdJRFNBQXdSUUloQUw1YnoxbkVUbnZURFh1anZmb0JuaWUzbGdQM3lFSUkKTXJUYXQzRy83WE5KQWlBeS9PV2E3TmVzb0VrR3RpU3UzTW5OMyszUzhZUHNab3NLR20xZEVpdWEvZz09Ci0tLS0tRU5EIENFUlRJRklDQVRFLS0tLS0K
    server: https://127.0.0.1:6443
  name: default
contexts:
- context:
    cluster: default
    user: default
  name: default
current-context: default
kind: Config
preferences: {}
users:
- name: default
  user:
    client-certificate-data: LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSUJrVENDQVRlZ0F3SUJBZ0lJT1R2MU5KRWhOSnd3Q2dZSUtvWkl6ajBFQXdJd0l6RWhNQjhHQTFVRUF3d1kKYXpOekxXTnNhV1Z1ZEMxallVQXhOelE0TVRnMU5UUTBNQjRYRFRJMU1EVXlOVEUxTURVME5Gb1hEVEkyTURVeQpOVEUxTURVME5Gb3dNREVYTUJVR0ExVUVDaE1PYzNsemRHVnRPbTFoYzNSbGNuTXhGVEFUQmdOVkJBTVRESE41CmMzUmxiVHBoWkcxcGJqQlpNQk1HQnlxR1NNNDlBZ0VHQ0NxR1NNNDlBd0VIQTBJQUJOQ3cyVmpqVjRBYjd6OUsKeXl5SlF4MmFXaUdpMElFUnRlNjRCZVBLM3RTUkVSdGJFdnE4Uk1aZVhXS0lTMVhSMTZrdjNKNE5sM2J1WFlKZAppZS9YSVB1alNEQkdNQTRHQTFVZER3RUIvd1FFQXdJRm9EQVRCZ05WSFNVRUREQUtCZ2dyQmdFRkJRY0RBakFmCkJnTlZIU01FR0RBV2dCU2EvK2pGbEl5c0hjRlhGN3FKTUluL0crTEt1VEFLQmdncWhrak9QUVFEQWdOSUFEQkYKQWlFQXV3aXRTU1NLeUZFaW5VSEZVZXFwV3F3bXIwTlFCMDhoU2ZmekxVazdkMFlDSURYRG1BbUZrczlsYUpNTApvanBXVkNTc3g4bW9XSXFSYzFuSWpGR09HcEJ6Ci0tLS0tRU5EIENFUlRJRklDQVRFLS0tLS0KLS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSUJkekNDQVIyZ0F3SUJBZ0lCQURBS0JnZ3Foa2pPUFFRREFqQWpNU0V3SHdZRFZRUUREQmhyTTNNdFkyeHAKWlc1MExXTmhRREUzTkRneE9EVTFORFF3SGhjTk1qVXdOVEkxTVRVd05UUTBXaGNOTXpVd05USXpNVFV3TlRRMApXakFqTVNFd0h3WURWUVFEREJock0zTXRZMnhwWlc1MExXTmhRREUzTkRneE9EVTFORFF3V1RBVEJnY3Foa2pPClBRSUJCZ2dxaGtqT1BRTUJCd05DQUFSNHk0Qmt5OFB5MVYxVjhnY0FVcU9KMUg0N0RnYWJjQVdsdldxc21ya2cKaUZxN2NOdGJTZThWK3NDdTVtcWtpa2dHcm1EUTgyRFpoQXJNeGhVSEVIZVRvMEl3UURBT0JnTlZIUThCQWY4RQpCQU1DQXFRd0R3WURWUjBUQVFIL0JBVXdBd0VCL3pBZEJnTlZIUTRFRmdRVW12L294WlNNckIzQlZ4ZTZpVENKCi94dml5cmt3Q2dZSUtvWkl6ajBFQXdJRFNBQXdSUUloQVBWbFI5d1JmVkQ1aDM5citsLytHVVZJNFJNV0dNN0YKVllrQVVlRHFLYmlOQWlCb2RmK251VzQ2L1QwdnNVemZ5V2FCVTgyNkxHTEs5bWt4VE9HMDYyV2p6Zz09Ci0tLS0tRU5EIENFUlRJRklDQVRFLS0tLS0K
    client-key-data: LS0tLS1CRUdJTiBFQyBQUklWQVRFIEtFWS0tLS0tCk1IY0NBUUVFSUJZcWdIU2hQNkNudUlpemJiK21KaXVsNE1aNUdJNStSSG54QU0rdnc2dnNvQW9HQ0NxR1NNNDkKQXdFSG9VUURRZ0FFMExEWldPTlhnQnZ2UDByTExJbERIWnBhSWFMUWdSRzE3cmdGNDhyZTFKRVJHMXNTK3J4RQp4bDVkWW9oTFZkSFhxUy9jbmcyWGR1NWRnbDJKNzljZyt3PT0KLS0tLS1FTkQgRUMgUFJJVkFURSBLRVktLS0tLQo=
`

func TestUpdateKubeConfig(t *testing.T) {
	result, err := updateKubeConfig(raw, "192.168.1.1")
	if err != nil {
		t.Fail()
	}
	if !strings.Contains(result, "server: https://192.168.1.1:6443") {
		t.Fail()
	}
}
