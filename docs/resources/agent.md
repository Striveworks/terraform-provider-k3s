---
# generated by https://github.com/hashicorp/terraform-plugin-docs
page_title: "k3s_agent Resource - k3s"
subcategory: ""
description: |-
  Creates a k3s agent resource. Only one of password or private_key can be passed. Requires a token and server address to a k3s_server resource
---

# k3s_agent (Resource)

Creates a k3s agent resource. Only one of `password` or `private_key` can be passed. Requires a token and server address to a k3s_server resource

## Example Usage

```terraform
variable "server_host" {
  type = string
}

variable "agent_hosts" {
  type = list(string)
}

variable "user" {
  type = string
}

variable "private_key" {
  type      = string
  sensitive = true
}

variable "config" {
  type    = string
  default = null
}

resource "k3s_server" "main" {
  auth = {
    host        = var.server_host
    user        = var.user
    private_key = var.private_key
  }
  config = var.config
}

resource "k3s_agent" "main" {
  count = length(var.agent_hosts)

  auth = {
    host        = var.agent_hosts[count.index]
    user        = var.user
    private_key = var.private_key
  }
  kubeconfig = k3s_server.main.kubeconfig
  server     = k3s_server.main.server
  token      = k3s_server.main.token
  config     = var.config
}
```

<!-- schema generated by tfplugindocs -->
## Schema

### Required

- `auth` (Attributes) Auth configuration for the node (see [below for nested schema](#nestedatt--auth))
- `kubeconfig` (String) KubeConfig for the cluster, needed so agent node can clean itself up
- `server` (String) Hostname for k3s api server
- `token` (String, Sensitive) Server token used for joining nodes to the cluster

### Optional

- `allow_delete_err` (Boolean) If this is true, deleting the node using kubectl first will be allowed to error not stopping the k3s uninstall process
- `bin_dir` (String) Value of a path used to put the k3s binary
- `config` (String) K3s server config
- `registry` (String) K3s agent registry

### Read-Only

- `active` (Boolean) The health of the server
- `id` (String) Id of the k3s server resource

<a id="nestedatt--auth"></a>
### Nested Schema for `auth`

Optional:

- `host` (String) Hostname of the target server
- `password` (String, Sensitive) Username of the target server
- `port` (Number) Override default SSH port (22)
- `private_key` (String, Sensitive) Private ssh key value to be used in place of a password
- `user` (String) Username of the target server
